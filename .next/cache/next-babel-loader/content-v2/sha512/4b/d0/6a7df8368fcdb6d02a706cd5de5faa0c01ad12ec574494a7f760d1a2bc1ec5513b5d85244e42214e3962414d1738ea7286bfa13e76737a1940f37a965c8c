{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"/Users/macbookpro/Desktop/Projects/Process-map/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/macbookpro/Desktop/Projects/Process-map/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/macbookpro/Desktop/Projects/Process-map/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/macbookpro/Desktop/Projects/Process-map/pages/process-background-information/index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useForm } from \"react-hook-form\";\nimport { CSVLink } from 'react-csv';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Router from 'next/router';\nimport Docxtemplater from \"docxtemplater\";\nimport PizZip from \"pizzip\";\nimport PizZipUtils from \"pizzip/utils/index.js\";\nimport { saveAs } from \"file-saver\";\nimport { convertObjectToArray } from '../../helpers/convertObjectArray';\nimport { saveProcessData } from '../../store/actions/phaseStore';\n\nvar ProcessBackgroundInformation = function ProcessBackgroundInformation() {\n  _s();\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      errors = _useForm.errors,\n      handleSubmit = _useForm.handleSubmit,\n      reset = _useForm.reset,\n      setValue = _useForm.setValue;\n\n  var dispatch = useDispatch(); // Use of Refs to target an element\n\n  var btnRef = useRef();\n  var saveRef = useRef();\n\n  var _useState = useState(true),\n      exportData = _useState[0],\n      setExportData = _useState[1];\n\n  var _useState2 = useState([]),\n      csvData = _useState2[0],\n      setCsvData = _useState2[1];\n\n  var theProcessData = useSelector(function (state) {\n    return state.phaseData.processInfo;\n  });\n  useEffect(function () {\n    // Check if there is a process data stored upon page load and set to each textareaa respectively\n    if (theProcessData && theProcessData.title) {\n      setValue('title', theProcessData.title);\n    }\n\n    if (theProcessData && theProcessData.doc_num) {\n      setValue('doc_num', theProcessData.doc_num);\n    }\n\n    if (theProcessData && theProcessData.purpose) {\n      setValue('purpose', theProcessData.purpose);\n    }\n\n    if (theProcessData && theProcessData.scope) {\n      setValue('scope', theProcessData.scope);\n    }\n\n    if (theProcessData && theProcessData.accountability) {\n      setValue('accountability', theProcessData.accountability);\n    }\n\n    if (theProcessData && theProcessData.responsibility) {\n      setValue('responsibility', theProcessData.responsibility);\n    }\n\n    if (theProcessData && theProcessData.references) {\n      setValue('references', theProcessData.references);\n    }\n\n    if (theProcessData && theProcessData.definitions) {\n      setValue('definitions', theProcessData.definitions);\n    }\n  }, [theProcessData]);\n  useEffect(function () {\n    // Load the docx file as binary content\n    var content = fs.readFileSync(path.resolve(__dirname, \"/lib/SOP-template.docx\"), \"binary\");\n    var zip = new PizZip(content);\n    var doc = new Docxtemplater(zip, {\n      paragraphLoop: true,\n      linebreaks: true\n    }); // Render the document (Replace {first_name} by John, {last_name} by Doe, ...)\n\n    doc.render({\n      first_name: \"John\",\n      last_name: \"Doe\",\n      phone: \"0652455478\",\n      description: \"New Website\"\n    });\n    var buf = doc.getZip().generate({\n      type: \"nodebuffer\",\n      // compression: DEFLATE adds a compression step.\n      // For a 50MB output document, expect 500ms additional CPU time\n      compression: \"DEFLATE\"\n    }); // buf is a nodejs Buffer, you can either write it to a file or res.send it with express for example.\n\n    fs.writeFileSync(path.resolve(__dirname, \"output.docx\"), buf);\n  }, []); // Headers for csv export\n\n  var headers = [{\n    label: 'Information',\n    key: 'information'\n  }, {\n    label: 'Value',\n    key: 'value'\n  }]; // CSV export object\n\n  var csvReport = {\n    filename: 'process-background.csv',\n    headers: headers,\n    data: csvData\n  }; // Function to export process background information\n\n  var exportBackgroundInformation = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n      var array;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              // Convert Object to an array for easy export\n              array = convertObjectToArray(data);\n              _context.next = 3;\n              return setCsvData(array);\n\n            case 3:\n              btnRef.current.link.click();\n              reset({}); // if export data is true, clear export data that is stored\n\n              if (exportData) {\n                dispatch(saveProcessData(null));\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function exportBackgroundInformation(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }(); // Function to save process background information\n\n\n  var saveprocessBackgroundInfo = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data) {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (exportData) {\n                _context2.next = 4;\n                break;\n              }\n\n              _context2.next = 3;\n              return dispatch(saveProcessData(data));\n\n            case 3:\n              return _context2.abrupt(\"return\");\n\n            case 4:\n              _context2.next = 6;\n              return exportBackgroundInformation(data);\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function saveprocessBackgroundInfo(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // Function to intiate going back\n\n\n  var gotoHome = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return setExportData(false);\n\n            case 2:\n              _context3.next = 4;\n              return saveRef.current.click();\n\n            case 4:\n              setTimeout(function () {\n                Router.push('/');\n              }, 200);\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function gotoHome() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"process-bg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12 mt-5\",\n              children: /*#__PURE__*/_jsxDEV(\"a\", {\n                onClick: gotoHome,\n                className: \"go-back\",\n                children: \"Go back\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 33\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: /*#__PURE__*/_jsxDEV(\"h1\", {\n                children: \"Process Background Information\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 33\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-12\",\n              children: [/*#__PURE__*/_jsxDEV(\"form\", {\n                onSubmit: handleSubmit(saveprocessBackgroundInfo),\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mb-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead pl-3\",\n                      children: \"Information\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 161,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 160,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 pr-sm-0 mb-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead pl-3\",\n                      children: \"Value\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 164,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 163,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"Title\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 167,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 166,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"title\",\n                      id: \"title\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 170,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 169,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"Doc_Num\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 174,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 173,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"doc_num\",\n                      id: \"doc_num\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 177,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 176,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"Purpose\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 181,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 180,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"purpose\",\n                      id: \"purpose\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 184,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 183,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"Scope\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 188,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 187,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"scope\",\n                      id: \"scope\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 191,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 190,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"Accountability\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 195,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 194,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"accountability\",\n                      id: \"accountability\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 198,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 197,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"Responsibility\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 202,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 201,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"responsibility\",\n                      id: \"responsibility\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 205,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 204,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"References\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 209,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 208,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"references\",\n                      id: \"references\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 212,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 211,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-3 pr-sm-0 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"thead bg-green pl-3\",\n                      children: \"Definitions\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 216,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 215,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-md-7 pl-sm-2 mt-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: register(),\n                      className: \"input-field\",\n                      name: \"definitions\",\n                      id: \"definitions\",\n                      cols: \"30\",\n                      rows: \"3\",\n                      placeholder: \"User inputs\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 219,\n                      columnNumber: 45\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 218,\n                    columnNumber: 41\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 37\n                }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    ref: saveRef,\n                    button: \"submit\",\n                    className: \"btn btn-green mt-4\",\n                    children: \"Export to data frame\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 224,\n                    columnNumber: 41\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 223,\n                  columnNumber: 37\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 33\n              }, _this), /*#__PURE__*/_jsxDEV(CSVLink, _objectSpread(_objectSpread({\n                className: \"d-none\",\n                ref: btnRef\n              }, csvReport), {}, {\n                children: \"Export\"\n              }), void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 33\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 29\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 13\n    }, _this)\n  }, void 0, false);\n};\n\n_s(ProcessBackgroundInformation, \"kDUCSlynsSAIcFQTwb+8/s4kUrs=\", false, function () {\n  return [useForm, useDispatch, useSelector];\n});\n\n_c = ProcessBackgroundInformation;\nexport default ProcessBackgroundInformation;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProcessBackgroundInformation\");","map":{"version":3,"sources":["/Users/macbookpro/Desktop/Projects/Process-map/pages/process-background-information/index.js"],"names":["React","useState","useRef","useEffect","useForm","CSVLink","useSelector","useDispatch","Router","Docxtemplater","PizZip","PizZipUtils","saveAs","convertObjectToArray","saveProcessData","ProcessBackgroundInformation","register","errors","handleSubmit","reset","setValue","dispatch","btnRef","saveRef","exportData","setExportData","csvData","setCsvData","theProcessData","state","phaseData","processInfo","title","doc_num","purpose","scope","accountability","responsibility","references","definitions","content","fs","readFileSync","path","resolve","__dirname","zip","doc","paragraphLoop","linebreaks","render","first_name","last_name","phone","description","buf","getZip","generate","type","compression","writeFileSync","headers","label","key","csvReport","filename","data","exportBackgroundInformation","array","current","link","click","saveprocessBackgroundInfo","gotoHome","setTimeout","push"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { useForm } from \"react-hook-form\";\nimport { CSVLink } from 'react-csv';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Router from 'next/router';\nimport Docxtemplater from \"docxtemplater\";\nimport PizZip from \"pizzip\";\nimport PizZipUtils from \"pizzip/utils/index.js\";\nimport { saveAs } from \"file-saver\";\n\nimport { convertObjectToArray } from '../../helpers/convertObjectArray';\nimport { saveProcessData } from '../../store/actions/phaseStore';\n\nconst ProcessBackgroundInformation = () => {\n    const {register, errors, handleSubmit, reset, setValue} = useForm();\n\n    const dispatch = useDispatch();\n\n    // Use of Refs to target an element\n    const btnRef = useRef();\n    const saveRef = useRef();\n\n    const [exportData, setExportData] = useState(true);\n    const [ csvData, setCsvData ] = useState([]);\n\n    const theProcessData = useSelector(state => state.phaseData.processInfo);\n\n    useEffect(() => {\n        // Check if there is a process data stored upon page load and set to each textareaa respectively\n        if (theProcessData && theProcessData.title) {\n            setValue('title', theProcessData.title);\n        }  \n\n        if (theProcessData && theProcessData.doc_num) {\n            setValue('doc_num', theProcessData.doc_num);\n        } \n\n        if (theProcessData && theProcessData.purpose) {\n            setValue('purpose', theProcessData.purpose);\n        }\n\n        if (theProcessData && theProcessData.scope) {\n            setValue('scope', theProcessData.scope);\n        } \n        if (theProcessData && theProcessData.accountability) {\n            setValue('accountability', theProcessData.accountability);\n        }  \n\n        if (theProcessData && theProcessData.responsibility) {\n            setValue('responsibility', theProcessData.responsibility);\n        } \n\n        if (theProcessData && theProcessData.references) {\n            setValue('references', theProcessData.references);\n        }\n\n        if (theProcessData && theProcessData.definitions) {\n            setValue('definitions', theProcessData.definitions);\n        } \n    }, [theProcessData]);\n\n    useEffect(() => {\n        // Load the docx file as binary content\n        const content = fs.readFileSync(\n            path.resolve(__dirname, \"/lib/SOP-template.docx\"),\n            \"binary\"\n        );\n        const zip = new PizZip(content);\n        const doc = new Docxtemplater(zip, {\n            paragraphLoop: true,\n            linebreaks: true,\n        });\n\n        // Render the document (Replace {first_name} by John, {last_name} by Doe, ...)\n        doc.render({\n            first_name: \"John\",\n            last_name: \"Doe\",\n            phone: \"0652455478\",\n            description: \"New Website\",\n        });\n\n        const buf = doc.getZip().generate({\n            type: \"nodebuffer\",\n            // compression: DEFLATE adds a compression step.\n            // For a 50MB output document, expect 500ms additional CPU time\n            compression: \"DEFLATE\",\n        });\n\n        // buf is a nodejs Buffer, you can either write it to a file or res.send it with express for example.\n        fs.writeFileSync(path.resolve(__dirname, \"output.docx\"), buf);\n    }, []);\n\n     // Headers for csv export\n    const headers = [\n        {label: 'Information', key: 'information'},\n        {label: 'Value', key: 'value'}\n    ];\n\n    // CSV export object\n    const csvReport = {\n        filename: 'process-background.csv',\n        headers: headers,\n        data: csvData\n    };\n\n    // Function to export process background information\n    const exportBackgroundInformation = async (data) => {\n        \n        // Convert Object to an array for easy export\n        const array = convertObjectToArray(data)\n        await setCsvData(array);\n        btnRef.current.link.click();\n        reset({});\n\n        // if export data is true, clear export data that is stored\n        if (exportData) {\n            dispatch(saveProcessData(null));\n        }\n    };\n\n    // Function to save process background information\n    const saveprocessBackgroundInfo = async (data) => {\n        // If exporting data is set to false upon initiating go back, store data to store\n        if (!exportData) {\n            await dispatch(saveProcessData(data));  \n            return;\n        }\n        // Else export data immediately\n        await exportBackgroundInformation(data);\n    };\n\n    // Function to intiate going back\n    const gotoHome = async () => {\n        await setExportData(false);\n        await saveRef.current.click();\n        setTimeout(() => {\n            Router.push('/');     \n        }, 200);\n    };\n\n    return (\n        <>\n            <section className='process-bg'>\n                <div className=\"container\">\n                    <div className=\"container\">\n                        <div className=\"row\">\n                            <div className=\"col-12 mt-5\">\n                                <a onClick={gotoHome} className=\"go-back\">\n                                    Go back\n                                </a>\n                            </div>\n                            <div className=\"col-12\">\n                                <h1>Process Background Information</h1>\n                            </div>\n                        </div>\n                        <div className=\"row\">\n                            <div className=\"col-12\">\n                                <form onSubmit={handleSubmit(saveprocessBackgroundInfo)}>\n                                    <div className=\"row\">\n                                        <div className=\"col-md-3 pr-sm-0 mb-2\">\n                                            <p className='thead pl-3'>Information</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 pr-sm-0 mb-2\">\n                                            <p className='thead pl-3'>Value</p>\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0\">\n                                            <p className='thead bg-green pl-3'>Title</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2\">\n                                            <textarea ref={register()} className='input-field' name=\"title\" id=\"title\" cols=\"30\" rows=\"3\" placeholder='User inputs'/>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"title\" placeholder='User inputs' /> */}\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0 mt-2\">\n                                            <p className='thead bg-green pl-3'>Doc_Num</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 mt-2\">\n                                            <textarea ref={register()} className='input-field' name=\"doc_num\" id=\"doc_num\" cols=\"30\" rows=\"3\" placeholder='User inputs'></textarea>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"doc_num\" placeholder='User inputs' /> */}\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0 mt-2\">\n                                            <p className='thead bg-green pl-3'>Purpose</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 mt-2\">\n                                            <textarea ref={register()} className='input-field' name=\"purpose\" id=\"purpose\" cols=\"30\" rows=\"3\" placeholder='User inputs'/>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"purpose\" placeholder='User inputs' /> */}\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0 mt-2\">\n                                            <p className='thead bg-green pl-3'>Scope</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 mt-2\">\n                                            <textarea ref={register()} className='input-field' name=\"scope\" id=\"scope\" cols=\"30\" rows=\"3\" placeholder='User inputs'/>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"scope\" placeholder='User inputs' /> */}\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0 mt-2\">\n                                            <p className='thead bg-green pl-3'>Accountability</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 mt-2\">\n                                            <textarea ref={register()} className='input-field' name=\"accountability\" id=\"accountability\" cols=\"30\" rows=\"3\" placeholder='User inputs'/>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"accountability\" placeholder='User inputs' /> */}\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0 mt-2\">\n                                            <p className='thead bg-green pl-3'>Responsibility</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 mt-2\">\n                                            <textarea ref={register()} className='input-field' name=\"responsibility\" id=\"responsibility\" cols=\"30\" rows=\"3\" placeholder='User inputs'/>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"responsibility\" placeholder='User inputs' /> */}\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0 mt-2\">\n                                            <p className='thead bg-green pl-3'>References</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 mt-2\">\n                                            <textarea ref={register()} className='input-field' name=\"references\" id=\"references\" cols=\"30\" rows=\"3\" placeholder='User inputs'/>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"references\" placeholder='User inputs' /> */}\n                                        </div>\n                                        <div className=\"col-md-3 pr-sm-0 mt-2\">\n                                            <p className='thead bg-green pl-3'>Definitions</p>        \n                                        </div>\n                                        <div className=\"col-md-7 pl-sm-2 mt-2\">\n                                            <textarea ref={register()} className='input-field' name=\"definitions\" id=\"definitions\" cols=\"30\" rows=\"3\" placeholder='User inputs'/>\n                                            {/* <input ref={register()} className='input-field' type=\"text\" name=\"definitions\" placeholder='User inputs' /> */}\n                                        </div>\n                                    </div>\n                                    <div className=\"text-center\">\n                                        <button ref={saveRef} button='submit' className=\"btn btn-green mt-4\">Export to data frame</button>\n                                    </div>\n                                </form>\n                                <CSVLink className='d-none' ref={btnRef} {...csvReport}>Export</CSVLink>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </section>\n        </>\n    )\n};\n\nexport default ProcessBackgroundInformation;"]},"metadata":{},"sourceType":"module"}